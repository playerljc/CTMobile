"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));function getReceiverByIntent(e){for(var r=[],t=0,i=this.receiverModel.length;t<i;t++){var n=this.receiverModel[t];if(n.action===e.action&&n.categorys.length===e.categorys.length){for(var a=!0,l=0;l<e.categorys.length;l++)if(-1===n.categorys.indexOf(e.categorys[l])){a=!1;break}a&&r.push(n)}}return r}var BorasdCast=function(){function e(){(0,_classCallCheck2.default)(this,e),Object.assign(this,{receiverModel:[]})}return(0,_createClass2.default)(e,[{key:"executeReceiverById",value:function(e,r){for(var t=0,i=this.receiverModel.length;t<i;t++){var n=this.receiverModel[t];n.innerReceiverId===e&&n.handler&&n.handler(r)}}},{key:"registerReceiver",value:function(e,r){r&&e&&e.action&&e.el&&this.receiverModel.push({el:e.el,action:e.action,categorys:e.categorys||[],handler:r,priority:e.priority||0})}},{key:"unregisterReceiver",value:function(e,r){if(e&&r)for(var t=0;t<this.receiverModel.length;){var i=this.receiverModel[t];i.action===e&&i.handler===r?(this.receiverModel.splice(t,1),t=0):t++}}},{key:"unregisterReceiverByDom",value:function(e){if(e)for(var r=0;r<this.receiverModel.length;){this.receiverModel[r].el===e?(this.receiverModel.splice(r,1),r=0):r++}}},{key:"sendBroadcast",value:function(e){if(e)for(var r=getReceiverByIntent.call(this,e),t=0,i=(r=[].concat(r)).length;t<i;t++)r[t].handler&&r[t].handler(Object.assign({},e))}},{key:"sendOrderedBroadcast",value:function(e){var i=0,n=!1,a={action:e.action,categorys:e.categorys||[],bundles:[]};if(e){var r=getReceiverByIntent.call(this,e);(r=[].concat(r)).sort(function(e,r){var t=e.priority||0,i=r.priority||0;return t<i?1:i<t?-1:0}),a.bundles.push(e.bundle||{}),function e(r){if(0===r.length)return;var t=r.shift();t&&(i++,n=!0,t.handler(a,{next:function(){n=!1,a.bundles.length!==i+1&&a.bundles.push({}),e(r)},putExtras:function(e){n&&(a.bundles.length===i+1&&a.bundles.pop(),a.bundles.push(e))}}))}(r)}}}]),e}(),_default=BorasdCast;exports.default=_default;