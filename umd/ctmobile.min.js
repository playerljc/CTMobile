!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var n={};t(n),e.Constant=n}}(this,function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=void 0;e.default={_debugger:!0,_SLIDEDURATION:500}}),function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var n={};t(n),e.BorasdCast=n}}(this,function(e){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e){for(var t=[],n=0,i=this.receiverModel.length;n<i;n++){var a=this.receiverModel[n];if(a.action===e.action&&a.categorys.length===e.categorys.length){for(var r=!0,o=0;o<e.categorys.length;o++)if(-1===a.categorys.indexOf(e.categorys[o])){r=!1;break}r&&t.push(a)}}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{receiverModel:[]})}var t,n,i;return t=e,(n=[{key:"executeReceiverById",value:function(e,t){for(var n=0,i=this.receiverModel.length;n<i;n++){var a=this.receiverModel[n];a.innerReceiverId===e&&a.handler&&a.handler(t)}}},{key:"registerReceiver",value:function(e,t){t&&e&&e.action&&e.el&&this.receiverModel.push({el:e.el,action:e.action,categorys:e.categorys||[],handler:t,priority:e.priority||0})}},{key:"unregisterReceiver",value:function(e,t){if(e&&t)for(var n=0;n<this.receiverModel.length;){var i=this.receiverModel[n];i.action===e&&i.handler===t?(this.receiverModel.splice(n,1),n=0):n++}}},{key:"unregisterReceiverByDom",value:function(e){if(e)for(var t=0;t<this.receiverModel.length;){this.receiverModel[t].el===e?(this.receiverModel.splice(t,1),t=0):t++}}},{key:"sendBroadcast",value:function(e){if(e)for(var t=o.call(this,e),n=0,i=(t=[].concat(t)).length;n<i;n++)t[n].handler&&t[n].handler(Object.assign({},e))}},{key:"sendOrderedBroadcast",value:function(e){var i=0,a=!1,r={action:e.action,categorys:e.categorys||[],bundles:[]};if(e){var t=o.call(this,e);(t=[].concat(t)).sort(function(e,t){var n=e.priority||0,i=t.priority||0;return n<i?1:i<n?-1:0}),r.bundles.push(e.bundle||{}),function e(t){if(0===t.length)return;var n=t.shift();n&&(i++,a=!0,n.handler(r,{next:function(){a=!1,r.bundles.length!==i+1&&r.bundles.push({}),e(t)},putExtras:function(e){a&&(r.bundles.length===i+1&&r.bundles.pop(),r.bundles.push(e))}}))}(t)}}}])&&a(t.prototype,n),i&&a(t,i),e}();e.default=t}),function(e,t){if("function"==typeof define&&define.amd)define(["exports","jquery","./CtMobile","./Constant"],t);else if("undefined"!=typeof exports)t(exports,require("jquery"),require("./CtMobile"),require("./Constant"));else{var n={};t(n,e.jquery,e.CtMobile,e.Constant),e.Router=n}}(this,function(e,u,c,l){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(){var e=window.location.hash;g.call(this,e)}function g(e,n){var i=this,t="";if(e){var a=(t=-1!==e.indexOf("?")?e.substring(1,e.indexOf("?")):e.substring(1)).lastIndexOf("_");if(-1===a)return!1;var r=t.substring(0,a);if(!window.document.querySelector("[ct-data-role='page'],#"+r))return!1;i.ctmobile.fireEvent(window.document,"pageBeforeChange",[c.default.getUrlParam(e)])}else{if(i.ctmobile.fireEvent(window.document,"pageBeforeChange",[c.default.getUrlParam(e)]),i.ctmobile.getFirstPage().getPageId()!==i.ctmobile.getFirstPageId())return void i.ctmobile.createPage(i.ctmobile.getId(i.ctmobile.getFirstPageId())).then(function(e){e.start(l.default._SLIDEDURATION,function(){i.removeFirstPage()})});t=i.ctmobile.getFirstPage().getId()}if(i.getPageById(t)){if(t===i.getLastPage().getId())return!1;for(var o=i.ctmobile.indexOfById(t),s=i.getHistoryLength()-1;o<s;s--)s===o+1?i.getPageByIndex(s).finish(l.default._SLIDEDURATION):i.getPageByIndex(s).finish(0)}else i.ctmobile.createPage(t).then(function(e){e.start(l.default._SLIDEDURATION,function(){if(n&&n.reload&&1<i.getHistoryLength()){var e=i.getHistoryLength()-2,t=i.getPageByIndex(e);t&&t.finish(0,null,n)}})})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,u=t(u),c=t(c),l=t(l);var n=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,{ctmobile:e,parameter:null,history:[]}),function(){var n=this;r=r.bind(this),window.addEventListener("hashchange",r,!1),(0,u.default)(window.document).on("pageBeforeChange",function(e,t){n.setParameter(t)})}.call(this)}var e,n,i;return e=t,(n=[{key:"startPage",value:function(e,i){var a=this,r="",o="";if(0!==e.indexOf("#")){var t=c.default.getUrlParam(e);r=t.pageId,delete t.pageId;var n=[];for(var s in t)t.hasOwnProperty(s)&&n.push(s+"="+t[s]);o=n.join("&")?"?"+n.join("&"):"",r in a.ctmobile.templateDB?l():u.default.ajax({dataType:"text",url:e,success:function(e){a.ctmobile.templateDB[r]=c.default.getPageTemplateStrByAjaxStr(e),a.ctmobile.preload((0,u.default)(a.ctmobile.templateDB[r])),l()},error:function(e,t,n){}})}else e=e.substring(1),r=-1!==e.indexOf("?")?(o=e.substring(e.indexOf("?")),e.substring(0,e.indexOf("?"))):e,l();function l(){var e,t=a.ctmobile.getTemplateConfig(r,"ct-data-mode");if(-1!==t.toLowerCase().indexOf("single")){var n=function(e){-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?")));for(var t=-1,n=0,i=this.getHistoryLength();n<i;n++)if(this.getPageByIndex(n).getPageId()===e){t=n;break}return t}.call(a,r);-1===n?(e=-1!==t.indexOf("singleInstance")&&a.ctmobile.getSingleInstance(r)?a.ctmobile.getSingleInstance(r).getId():a.ctmobile.getId(r+o),i&&i.reload?(window.history.replaceState(null,"","#"+e),g.call(a,"#"+e,i)):window.location.hash="#"+e):a.ctmobile.getPageByIndex(n)!==a.getLastPage()?a.go(-(a.getHistoryLength()-1-n)):a.ctmobile.fireEvent(a.getLastPage().getPageDOM(),"pageShow")}else"standard"!==t&&"result"!==t||(e=a.ctmobile.getId(r+o),i&&i.reload?(window.history.replaceState(null,"","#"+e),g.call(a,"#"+e,i)):window.location.hash="#"+e)}}},{key:"go",value:function(e){window.history.go(e)}},{key:"back",value:function(){this.go(-1)}},{key:"setParameter",value:function(e){this.parameter=e}},{key:"getParameter",value:function(){var e=Object.assign({},this.parameter);return e.pageId&&delete e.pageId,e}},{key:"getPageById",value:function(e){return this.history[this.ctmobile.indexOfById(e)]}},{key:"getPageByIndex",value:function(e){return this.history[e]}},{key:"getLastPage",value:function(){return this.history[this.history.length-1]}},{key:"getHistoryLength",value:function(){return this.history.length}},{key:"addPage",value:function(e){this.history.push(e)}},{key:"removeFirstPage",value:function(){this.history.shift()}},{key:"removeLastPage",value:function(){this.history.pop()}},{key:"removePageByIndex",value:function(e){this.history.splice(e,1)}}])&&a(e.prototype,n),i&&a(e,i),t}();e.default=n}),function(e,t){if("function"==typeof define&&define.amd)define(["exports","jquery","./Constant"],t);else if("undefined"!=typeof exports)t(exports,require("jquery"),require("./Constant"));else{var n={};t(n,e.jquery,e.Constant),e.Page=n}}(this,function(e,a,o){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t){for(var n=0,i=e.length;n<i;n++)t&&t.call(e[n],e[n],n)}function s(e){this.ctmobile.router.go(e)}function l(){var t=this;this._pDom=(0,a.default)(this.ctmobile.templateDB[this.pageId])[0],this._pDom.setAttribute("id",this.id),n(this._pDom.querySelectorAll("[id]"),function(){this.setAttribute("id",t.id+this.getAttribute("id"))}),n(this._pDom.querySelectorAll("label[for]"),function(){this.setAttribute("for",t.id+this.getAttribute("for"))}),n(this._pDom.querySelectorAll("input[list]"),function(){this.setAttribute("list",t.id+this.getAttribute("list"))}),n(this._pDom.querySelectorAll("datalist[id]"),function(){this.setAttribute("id",t.id+this.getAttribute("id"))}),this._pDom.getAttribute("ct-data-transition")&&(this.transition=this._pDom.getAttribute("ct-data-transition")),function(){var t=this;function e(e){console.log(o.default._debugger,"------------------------------onTransitionAndAnimationEnd"),"webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("ct-data-role")||t.pageTransitionType&&("start"===t.pageTransitionType?(delete t.pageTransitionType,function(e){var t=this;if("webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("ct-data-role")||"webkitAnimationEnd"===e.type&&"page"!==e.target.getAttribute("ct-data-role"))return;e.stopPropagation(),e.preventDefault(),t.getPageDOM().classList.remove("materialShow"),t.ctmobile.getLastPage().getPageDOM().classList.remove("active"),t.ctmobile.maskDOM.style.display="none",t.changeKey=!1,t.ctmobile.router.addPage(t),t.ctmobile.fireEvent(t.getPageDOM(),"pageAfterShow"),2<=t.ctmobile.getHistoryLength()&&t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(t.ctmobile.getHistoryLength()-2).getPageDOM(),"pageAfterPause");t.pageTransitionEndCallback&&t.pageTransitionEndCallback()}.call(t,e)):"finish"===t.pageTransitionType&&(delete t.pageTransitionType,function(e){var t=this;if("webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("ct-data-role")||"webkitAnimationEnd"===e.type&&"page"!==e.target.getAttribute("ct-data-role"))return;e.stopPropagation(),e.preventDefault(),t.getPageDOM().classList.remove("materialHide"),t.getPageDOM().classList.remove("active"),t.ctmobile.maskDOM.style.display="none",t.changeKey=!1;var n=t.ctmobile.getTemplateConfig(t.getPageId(),"ct-data-mode");-1===n.toLowerCase().indexOf("singleinstance")&&t.getPageDOM().parentNode.removeChild(t.getPageDOM());if(1<t.ctmobile.getHistoryLength()){var i=t.ctmobile.getHistoryLength()-2;t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(i).getPageDOM(),"pageAfterRestore"),-1!==n.toLowerCase().lastIndexOf("result")&&t.resultIntent&&t.resultIntent.resultCode&&t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(i).getPageDOM(),"pageResult",[t.resultIntent.resultCode,t.resultIntent.bundle])}t.ctmobile.router.removeLastPage(),t.pageTransitionEndCallback&&t.pageTransitionEndCallback()}.call(t,e)))}t.getPageJO().on({pageCreate:t.pageCreate.bind(t),pageBeforeShow:t.pageBeforeShow.bind(t),pageShow:t.pageShow.bind(t),pageAfterShow:t.pageAfterShow.bind(t),pageBeforePause:t.pageBeforePause.bind(t),pageAfterPause:t.pageAfterPause.bind(t),pageBeforeRestore:t.pageBeforeRestore.bind(t),pageRestore:t.pageRestore.bind(t),pageAfterRestore:t.pageAfterRestore.bind(t),pageBeforeDestroy:t.pageBeforeDestroy.bind(t),pageResult:t.pageResult.bind(t),pageReceiver:t.pageReceiver.bind(t)}),t.getPageDOM().addEventListener("webkitTransitionEnd",e,!1),t.getPageDOM().addEventListener("webkitAnimationEnd",e,!1)}.call(this),this._pDom.getAttribute("ct-data-intentfilter-action")&&this.ctmobile.registerReceiver({el:this._pDom,action:this._pDom.getAttribute("ct-data-intentfilter-action"),priority:this._pDom.getAttribute("ct-data-intentfilter-priority")?parseInt(this._pDom.getAttribute("ct-data-intentfilter-priority")):0,categorys:this._pDom.getAttribute("ct-data-intentfilter-categorys")?this._pDom.getAttribute("ct-data-intentfilter-categorys").split(" "):[]},this.pageReceiver),this._pDom.addEventListener("click",function(e){e.target.getAttribute("ct-data-rel")&&"back"===e.target.getAttribute("ct-data-rel")&&s.call(t,-1)},!1),window.document.body.appendChild(this._pDom),this.ctmobile.fireEvent(this._pDom,"pageCreate")}function u(e,t,n,i){var a=this,r=0,o=0;"reset"===t?function(){new RegExp(/.+left/g).exec(e)?r="100%":new RegExp(/.+right/g).exec(e)?r="-100%":new RegExp(/.+up/g).exec(e)?o="100%":new RegExp(/.+down/g).exec(e)&&(o="-100%"),0===e.indexOf("wx")&&0!==n?(delete a.ctmobile.getPageByIndex(a.ctmobile.getHistoryLength()-2).pageTransitionType,c.call(a.ctmobile.getPageByIndex(a.ctmobile.getHistoryLength()-2),0,0,n/2)):0===e.indexOf("push")&&0!==n&&(delete a.ctmobile.getPageByIndex(a.ctmobile.getHistoryLength()-2).pageTransitionType,c.call(a.ctmobile.getPageByIndex(a.ctmobile.getHistoryLength()-2),0,0,n)),0===e.indexOf("material")?0!==n&&(i&&i(),this.getPageDOM().classList.add("materialHide")):c.call(this,r,o,n,i)}.call(a):function(){0===e.indexOf("wx")&&0!==n?(delete a.ctmobile.getLastPage().pageTransitionType,new RegExp(/.+left/g).exec(e)?c.call(a.ctmobile.getLastPage(),"-20%",o,n/2):new RegExp(/.+right/g).exec(e)?c.call(a.ctmobile.getLastPage(),"20%",o,n/2):new RegExp(/.+up/g).exec(e)?c.call(a.ctmobile.getLastPage(),r,"-20%",n/2):new RegExp(/.+down/g).exec(e)&&c.call(a.ctmobile.getLastPage(),r,"20%",n/2)):0===e.indexOf("push")&&0!==n&&(delete a.ctmobile.getLastPage().pageTransitionType,new RegExp(/.+left/g).exec(e)?c.call(a.ctmobile.getLastPage(),"-100%",o,n):new RegExp(/.+right/g).exec(e)?c.call(a.ctmobile.getLastPage(),"100%",o,n):new RegExp(/.+up/g).exec(e)?c.call(a.ctmobile.getLastPage(),r,"-100%",n):new RegExp(/.+down/g).exec(e)&&c.call(a.ctmobile.getLastPage(),r,"100%",n)),0===e.indexOf("material")?0!==n&&(i&&i(),a.getPageDOM().classList.add("materialShow")):c.call(this,r,o,n,i)}.call(a)}function c(e,t,n,i){var a=this;function r(){a.getPageJO().css({transform:"translate3d("+e+","+t+",0)","-webkit-transform":"translate3d("+e+","+t+",0)",transition:"transform "+n+"ms cubic-bezier(0.1,0.25,0.1,1)","-webkit-transition":"transform "+n+"ms cubic-bezier(0.1,0.25,0.1,1)"})}i&&i(),0===n?r():window.setTimeout(r,100)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a=t(a),o=t(o);var i=function(){function n(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),Object.assign(this,{ctmobile:e,id:t,pageId:t.substring(0,t.lastIndexOf("_")),transition:"material",changeKey:!1,pageTransitionType:null,pageTransitionEndCallback:null}),l.call(this),function(){u.call(this,this.transition,"reset",0)}.call(this),this}var e,t,i;return e=n,(t=[{key:"pageCreate",value:function(e){}},{key:"pageBeforeShow",value:function(e){}},{key:"pageShow",value:function(e){}},{key:"pageAfterShow",value:function(e){}},{key:"pageBeforePause",value:function(e){}},{key:"pageAfterPause",value:function(e){}},{key:"pageBeforeRestore",value:function(e){}},{key:"pageRestore",value:function(e){}},{key:"pageAfterRestore",value:function(e){}},{key:"pageBeforeDestroy",value:function(e){}},{key:"pageResult",value:function(e,t,n){}},{key:"pageReceiver",value:function(e,t){}},{key:"start",value:function(e,t){var n=this;n.changeKey||(n.changeKey=!0,n.pageTransitionType="start",n.pageTransitionEndCallback=t,0!==n.ctmobile.getHistoryLength()&&n.ctmobile.fireEvent(n.ctmobile.getLastPage().getPageDOM(),"pageBeforePause"),n.ctmobile.fireEvent(n.getPageDOM(),"pageBeforeShow"),0!==e&&(n.ctmobile.maskDOM.style.display="block"),n.getPageDOM().classList.add("active"),n.getPageDOM().style.zIndex=++n.ctmobile.zIndex,n.ctmobile.fireEvent(n.getPageDOM(),"pageShow"),u.call(n,n.transition,"show",0===e?0:o.default._SLIDEDURATION),0===e&&(n.ctmobile.router.addPage(n),n.changeKey=!1,n.ctmobile.fireEvent(n.getPageDOM(),"pageAfterShow"),t&&t()))}},{key:"finish",value:function(e,t,n){var i=this;if(!i.changeKey){i.changeKey=!0,i.pageTransitionType="finish",i.ctmobile.zIndex--,i.pageTransitionEndCallback=t;var a=i.ctmobile.getTemplateConfig(i.getPageId(),"ct-data-mode");-1===a.toLowerCase().indexOf("singleinstance")?(i.ctmobile.fireEvent(i.getPageDOM(),"pageBeforeDestroy"),i.ctmobile.unregisterReceiverByDom(i.getPageDOM())):i.ctmobile.fireEvent(i.getPageDOM(),"pageAfterPause");var r=i.ctmobile.getHistoryLength()-2;!(1<i.ctmobile.getHistoryLength())||n&&n.reload||i.ctmobile.fireEvent(i.ctmobile.getPageByIndex(r).getPageDOM(),"pageBeforeRestore"),0!==e&&(i.ctmobile.maskDOM.style.display="block"),!(1<i.ctmobile.getHistoryLength())||n&&n.reload||(i.ctmobile.getPageByIndex(r).getPageDOM().classList.add("active"),i.ctmobile.fireEvent(i.ctmobile.getPageByIndex(r).getPageDOM(),"pageRestore")),u.call(this,this.transition,"reset",0===e?0:o.default._SLIDEDURATION),0===e&&(i.getPageDOM().classList.remove("active"),i.changeKey=!1,-1===a.toLowerCase().indexOf("singleinstance")&&i.getPageDOM().parentNode.removeChild(i.getPageDOM()),!(1<i.ctmobile.getHistoryLength())||n&&n.reload||(i.ctmobile.fireEvent(i.ctmobile.getPageByIndex(r).getPageDOM(),"pageAfterRestore"),-1!==a.toLowerCase().lastIndexOf("result")&&i.resultIntent&&i.resultIntent.resultCode&&i.ctmobile.fireEvent(i.ctmobile.getPageByIndex(r).getPageDOM(),"pageResult",[i.resultIntent.resultCode,i.resultIntent.bundle])),1<i.ctmobile.getHistoryLength()&&n&&n.reload?i.ctmobile.router.removePageByIndex(r,1):i.ctmobile.router.removeLastPage(),t&&t())}}},{key:"getPageDOM",value:function(){return this._pDom}},{key:"getPageJO",value:function(){return this._pJO||(this._pJO=(0,a.default)(this.getPageDOM())),this._pJO}},{key:"getId",value:function(){return this.id}},{key:"getPageId",value:function(){return this.pageId}},{key:"setRequest",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.requestIntent={requestCode:e,bundle:t}}},{key:"getRequest",value:function(e){return this.ctmobile.getRequest(this)}},{key:"setResult",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.resultIntent={resultCode:e,bundle:t}}},{key:"getResult",value:function(e){return this.resultIntent}},{key:"over",value:function(){s.call(this,-1)}},{key:"getCtMobile",value:function(){return this.ctmobile}}])&&r(e.prototype,t),i&&r(e,i),n}();e.default=i}),function(e,t){if("function"==typeof define&&define.amd)define(["exports","jquery","./Page","./Router","./BorasdCast"],t);else if("undefined"!=typeof exports)t(exports,require("jquery"),require("./Page"),require("./Router"),require("./BorasdCast"));else{var n={};t(n,e.jquery,e.Page,e.Router,e.BorasdCast),e.CtMobile=n}}(this,function(e,c,s,a,r){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=function(e){return-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),(0,c.default)(this.templateDB[e])[0]}.call(this,e).getAttribute(t);return"ct-data-mode"!==t||n||(n="standard"),n}function g(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];(0,c.default)(e).trigger(t,n)}function d(t){var l=this,u=this;return new Promise(function(e,o){var s=[];console.time("预加载Ajax用时"),(0,c.default)(t).find("a[ct-data-preload=true][ct-pageId]").each(function(e,t){var n=t.getAttribute("ct-data-ajax"),i=t.getAttribute("ct-pageId");if(!i&&n&&"false"===n)return!1;var a=u.config.router[i],r=a&&a.url?a.url:"";if(!r)return!1;s.push(c.default.ajax({dataType:"text",url:r,success:function(e){l.templateDB[i]=v.getPageTemplateStrByAjaxStr(e)},error:function(e,t,n){o(e)}}))}),0!==s.length?Promise.all(s).then(function(){console.timeEnd("预加载Ajax用时"),e()}).catch(function(){o()}):e()})}function f(e){var t,n=e.Class,i=e.id,a=e.pageId,r=l(n).toLowerCase(),o=u.call(this,a,"ct-data-mode");if("function"===r?t=n:"undefined"===r&&(t=s.default),!t)throw"页面管理类无法初始化";return-1!==o.toLowerCase().indexOf("singleinstance")?(this.getSingleInstance(a)||(this.singleInstances[a]=new t(this,i)),this.singleInstances[a]):new t(this,i)}function h(r){var o=this;return new Promise(function(t,n){var i,a=r.substring(0,r.lastIndexOf("_"));if(o.config.router[a]){var e=o.config.router[a].component;e&&e.then?e.then(function(e){e&&(i=e.default)?t(f.call(o,{Class:i,id:r,pageId:a})):n()}).catch(function(e){n(e)}):t(f.call(o,{Page:s.default,id:r,pageId:a}))}else t(f.call(o,{Page:s.default,id:r,pageId:a}))})}function n(){var e=this,r=this;this.hasInited||(this.hasInited=!0,this.bodyDOM=window.document.body,this.singleInstances=null,this.maskDOM=(0,c.default)("<div class='ct-page-mask'> <div opt='animation' class='la-ball-circus la-dark' style='color:#3e98f0;'>   <div></div>   <div></div>   <div></div>   <div></div>   <div></div> </div></div>")[0],this.bodyDOM.appendChild(this.maskDOM),Promise.all([function(){var i=this,a=this;return new Promise(function(e,t){console.time("初始化本地模板用时:");var n=[];(0,c.default)(i.bodyDOM).find("div[ct-data-role='page']").each(function(){a.templateDB[this.getAttribute("id")]=this.outerHTML,n.push(d.call(a,this)),this.parentNode.removeChild(this)}),Promise.all(n).then(function(){console.timeEnd("初始化本地模板用时:"),e()}).catch(function(e){t(e)})})}.call(this),function(){var s=this;return new Promise(function(e){console.time("捕获a标签用时:"),window.document.addEventListener("click",function(e){e.preventDefault();var t=e.target;if(t&&("a"===t.tagName.toLocaleLowerCase()||(t=v.getParentElementByTag(t,"a")))){var n=t.getAttribute("ct-data-ajax");if(!n||"false"!==n){var i=t.getAttribute("ct-pageId"),a=t.getAttribute("ct-parameter")||"";if(i){var r=s.config.router[i],o="".concat(r&&r.url?r.url:"#"+i,"?pageId=").concat(i).concat(a);return s.startPage(o,{reload:"true"===t.getAttribute("ct-reload")||s.config.linkCaptureReload}),!1}}}}),console.timeEnd("捕获a标签用时:"),e()})}.call(this)]).then(function(){console.timeEnd("总用时"),g(window.document,"pageBeforeChange",[v.getUrlParam(window.location.hash)]),h.call(e,e.getFirstId()).then(function(e){e.start(0,function(){if(!window.location.hash)return!1;var e=r.getPageIdByHash();if(!e)return!1;var t=r.config.router[e];if(!t||t.url){var n=t&&t.url?t.url:"#".concat(e),i=r.getParameterByHash(),a=v.getUrlParam("".concat(n).concat(i));r.startPage("".concat(n).concat(i).concat(i?a.pageId?"":"&pageId=".concat(e):"?pageId=".concat(e)),{reload:r.config.linkCaptureReload})}})})}))}function p(){var e=this.config.supportCordova,t=void 0!==e&&e;n=n.bind(this),t?Promise.all([new Promise(function(e){(0,c.default)(window.document).ready(function(){e()})}),new Promise(function(e){window.addEventListener("DOMContentLoaded",function(){e()})}),new Promise(function(e){window.document.addEventListener("deviceready",function(){e()})})]).then(function(){n(),g(window.document,"DOMContentAndDeviceReady")}).catch(function(e){}):((0,c.default)(window.document).ready(n),window.addEventListener("DOMContentLoaded",n))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,c=t(c),s=t(s),a=t(a),r=t(r);var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.hasInited=!1,this.templateDB={},this.zIndex=0,this.router=new a.default(this),this.borasdcast=new r.default,p.call(this)}var e,n,i;return e=t,(n=[{key:"startPage",value:function(e,t){this.router.startPage(e,t)}},{key:"createPage",value:function(e){return h.call(this,e)}},{key:"preload",value:function(e){return function(i){var a=this;return new Promise(function(e,t){var n=[];n.push(d.call(a,i)),Promise.all(n).then(function(){e()}).catch(function(e){t(e)})})}.call(this,e)}},{key:"back",value:function(){this.router.go(-1)}},{key:"getFirstId",value:function(){return this.getId(this.getFirstPageId())}},{key:"getId",value:function(e){var t=e.indexOf("?");return-1!==t?e.substring(0,t)+"_"+(new Date).getTime()+e.substring(t):e+"_"+(new Date).getTime()}},{key:"getPageIdByHash",value:function(){var e=window.location.hash;return e?-1!==e.indexOf("?")?(e=e.substring(0,e.lastIndexOf("?"))).substring(1,e.lastIndexOf("_")):e.substring(1,e.lastIndexOf("_")):""}},{key:"getParameterByHash",value:function(){var e=window.location.hash;return e&&-1!==e.indexOf("?")?e.substring(e.lastIndexOf("?")):""}},{key:"getFirstPageId",value:function(){var e;for(var t in this.templateDB){e=t;break}return e}},{key:"getPageById",value:function(e){return this.router.getPageById(this.indexOfById(e))}},{key:"getSingleInstance",value:function(e){return this.singleInstances||(this.singleInstances={}),this.singleInstances[e]}},{key:"fireEvent",value:function(e,t,n){g(e,t,n)}},{key:"getTemplateConfig",value:function(e,t){return u.call(this,e,t)}},{key:"getPageByIndex",value:function(e){return this.router.getPageByIndex(e)}},{key:"indexOfById",value:function(e){for(var t=-1,n=0,i=this.getHistoryLength();n<i;n++)if(this.getPageByIndex(n).getId()===e){t=n;break}return t}},{key:"getFirstPage",value:function(){return this.router.getPageByIndex(0)}},{key:"getLastPage",value:function(){return this.router.getLastPage()}},{key:"getParameter",value:function(){return this.router.getParameter()}},{key:"getHistoryLength",value:function(){return this.router.getHistoryLength()}},{key:"getRequest",value:function(e){if(0===this.getHistoryLength()||1===this.getHistoryLength())return{};var t=this.indexOfById(e.getId());return t<=0||t>this.getHistoryLength()-1?{}:this.getPageByIndex(this.getHistoryLength()-2).requestIntent||{}}},{key:"registerReceiver",value:function(e,t){this.borasdcast.registerReceiver(e,t)}},{key:"executeReceiverById",value:function(e,t){this.borasdcast.executeReceiverById(e,t)}},{key:"unregisterReceiver",value:function(e,t){this.borasdcast.unregisterReceiver(e,t)}},{key:"unregisterReceiverByDom",value:function(e){this.borasdcast.unregisterReceiverByDom(e)}},{key:"sendBroadcast",value:function(e){this.borasdcast.sendBroadcast(e)}},{key:"sendOrderedBroadcast",value:function(e){this.borasdcast.sendOrderedBroadcast(e)}}])&&o(e.prototype,n),i&&o(e,i),t}(),v={getUrlParam:function(e){var t=/([^&=]+)=([\w\W]*?)(&|$)/g,n=/^[^\?]+\?([\w\W]+)$/.exec(e),i={};if(n&&n[1])for(var a,r=n[1];null!=(a=t.exec(r));)i[a[1]]=decodeURI(a[2]);return i},getParentElementByTag:function(e,n){if(!n)return null;var i=null,a=e;return function e(){if(!(a=a.parentElement))return null;var t=a.tagName.toLocaleLowerCase();t===n?i=a:"body"===t?i=null:e()}(),i},getPageTemplateStrByAjaxStr:function(e){var t;if(e=e.trim(),new RegExp("(<[^>]+\\bct-data-role=[\"']?page[\"']?[^>]*>)").test(e)){var n=e.split(/<\/?body[^>]*>/gim);t=(0,c.default)((0===(n||[]).length?"":1<n.length?n[1]:n[0])||"")[0]}return t?t.outerHTML:""},create:function(e){return new i(e)}},y=v;e.default=y}),function(e,t){if("function"==typeof define&&define.amd)define(["exports","./CtMobile","./Page"],t);else if("undefined"!=typeof exports)t(exports,require("./CtMobile"),require("./Page"));else{var n={};t(n,e.CtMobile,e.Page),e.CtMobile=n}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=i(t),n=i(n);var a={CtMobileFactory:t.default,Page:n.default};e.default=a});